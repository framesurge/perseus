<!DOCTYPE html>
<html lang="en" class="light">
    <head>
<base href="https://arctic-hen7.github.io/perseus/" />
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="stylesheet" href=".perseus/static/tailwind.css" />
        <link rel="stylesheet" href=".perseus/static/styles/style.css" />
    <script>window.__PERSEUS_RENDER_CFG = '{"docs/0.1.x/tutorials/first_app/setup":"docs","docs/next/second-app":"docs","docs/strategies/build-state":"docs","docs/0.3.x/strategies/intro":"docs","docs/next/advanced/subsequent-loads":"docs","docs/cli":"docs","docs/next/strategies/amalgamation":"docs","docs/advanced/subsequent-loads":"docs","docs/0.3.x/define-app":"docs","docs/0.3.x/advanced/intro":"docs","docs/next/templates/intro":"docs","docs/define-app":"docs","docs/0.2.x/static-content":"docs","docs/0.2.x/styling":"docs","docs/0.2.x/error-pages":"docs","docs/next/advanced/initial-loads":"docs","docs/0.3.x/strategies/incremental":"docs","docs/views":"docs","docs/0.2.x/debugging":"docs","docs/next/deploying/serverful":"docs","docs/next/server-communication":"docs","docs/0.2.x/templates/metadata-modification":"docs","docs/0.3.x/styling":"docs","docs/0.2.x/strategies/amalgamation":"docs","docs/next/intro":"docs","docs/0.3.x/what-is-perseus":"docs","docs/0.3.x/plugins/writing":"docs","docs/0.2.x/advanced/routing":"docs","docs/0.2.x/config-managers":"docs","docs/0.2.x/strategies/build-state":"docs","docs/next/plugins/functional":"docs","docs/0.1.x/error_pages":"docs","docs/0.3.x/testing/manual":"docs","docs/next/i18n/using":"docs","docs/next/i18n/other-engines":"docs","docs/0.3.x/i18n/other-engines":"docs","docs/0.3.x/advanced/arch":"docs","docs/0.3.x/advanced/subsequent-loads":"docs","docs/i18n/translations-managers":"docs","docs/0.3.x/ejecting":"docs","docs/testing/manual":"docs","docs/advanced/arch":"docs","docs/testing/checkpoints":"docs","docs/0.2.x/testing/manual":"docs","docs/static-content":"docs","docs/0.3.x/plugins/control":"docs","docs/0.3.x/testing/intro":"docs","docs/0.1.x/templates":"docs","docs/0.1.x/strategies/revalidation":"docs","docs/next/what-is-perseus":"docs","docs/next/advanced/routing":"docs","docs/0.1.x/strategies/incremental":"docs","docs/config-managers":"docs","docs/0.3.x/templates/intro":"docs","docs/next/plugins/intro":"docs","docs/0.3.x/hello-world":"docs","docs/0.3.x/exporting":"docs","docs/0.3.x/deploying/intro":"docs","docs/0.2.x/i18n/translations-managers":"docs","docs/next/plugins/tinker":"docs","docs/next/strategies/incremental":"docs","docs/0.3.x/deploying/serverful":"docs","docs/0.2.x/advanced/arch":"docs","docs/next/deploying/relative-paths":"docs","docs/next/exporting":"docs","docs/0.3.x/deploying/serverless":"docs","docs/0.1.x/strategies/build_state":"docs","docs/0.2.x/hello-world":"docs","docs/next/i18n/defining":"docs","docs/0.1.x/strategies/build_paths":"docs","docs/next/strategies/build-paths":"docs","docs/updating":"docs","docs/next/strategies/revalidation":"docs","docs/next/testing/manual":"docs","docs/0.2.x/deploying/intro":"docs","docs/0.2.x/what-is-perseus":"docs","docs/next/plugins/security":"docs","docs/strategies/build-paths":"docs","docs/templates/setting-headers":"docs","docs/0.2.x/i18n/intro":"docs","docs":"docs","docs/0.3.x/i18n/defining":"docs","docs/templates/metadata-modification":"docs","docs/0.3.x/testing/fantoccini-basics":"docs","docs/0.2.x/define-app":"docs","docs/0.1.x/building":"docs","docs/strategies/revalidation":"docs","docs/0.3.x/deploying/relative-paths":"docs","docs/next/templates/setting-headers":"docs","docs/strategies/incremental":"docs","docs/0.3.x/cli":"docs","docs/0.3.x/stores":"docs","docs/0.2.x/views":"docs","docs/0.1.x/config_managers":"docs","docs/0.3.x/i18n/translations-managers":"docs","docs/testing/fantoccini-basics":"docs","docs/next/styling":"docs","docs/0.2.x/strategies/revalidation":"docs","docs/0.3.x/advanced/routing":"docs","docs/0.3.x/debugging":"docs","docs/next/i18n/intro":"docs","docs/0.2.x/second-app":"docs","docs/deploying/intro":"docs","docs/next/strategies/request-state":"docs","docs/next/plugins/control":"docs","docs/next/strategies/build-state":"docs","docs/0.2.x/ejecting":"docs","docs/next/plugins/writing":"docs","docs/0.2.x/strategies/incremental":"docs","docs/strategies/request-state":"docs","docs/0.1.x/tutorials/first_app/app":"docs","docs/0.1.x/serving":"docs","docs/0.2.x/i18n/defining":"docs","docs/advanced/intro":"docs","docs/i18n/defining":"docs","docs/next/testing/checkpoints":"docs","docs/0.3.x/updating":"docs","docs/error-pages":"docs","docs/0.3.x/second-app":"docs","docs/debugging":"docs","docs/0.2.x/strategies/request-state":"docs","docs/0.3.x/plugins/using":"docs","docs/next/advanced/intro":"docs","docs/strategies/amalgamation":"docs","docs/0.3.x/plugins/tinker":"docs","docs/second-app":"docs","comparisons":"comparisons","docs/0.3.x/deploying/size":"docs","docs/0.3.x/error-pages":"docs","docs/what-is-perseus":"docs","docs/next/deploying/size":"docs","docs/0.1.x/tutorials/first_app/template":"docs","docs/0.2.x/cli":"docs","docs/ejecting":"docs","docs/next/i18n/translations-managers":"docs","docs/0.1.x/setup":"docs","docs/i18n/intro":"docs","docs/0.3.x/intro":"docs","docs/strategies/intro":"docs","docs/0.3.x/strategies/build-paths":"docs","docs/0.3.x/advanced/initial-loads":"docs","docs/0.3.x/strategies/revalidation":"docs","docs/0.1.x/tutorials/first_app/intro":"docs","docs/styling":"docs","docs/0.1.x/routing":"docs","docs/0.3.x/static-content":"docs","docs/0.3.x/plugins/intro":"docs","docs/advanced/initial-loads":"docs","docs/next/ejecting":"docs","docs/next/error-pages":"docs","docs/0.2.x/strategies/intro":"docs","docs/0.2.x/templates/setting-headers":"docs","docs/next/stores":"docs","docs/0.1.x/strategies/intro":"docs","docs/0.3.x/templates/metadata-modification":"docs","docs/0.2.x/i18n/using":"docs","docs/0.2.x/deploying/exporting":"docs","index":"index","docs/0.2.x/updating":"docs","docs/i18n/using":"docs","docs/0.2.x/testing/fantoccini-basics":"docs","docs/testing/intro":"docs","docs/0.3.x/views":"docs","docs/0.2.x/testing/intro":"docs","docs/0.2.x/advanced/subsequent-loads":"docs","docs/0.1.x/intro":"docs","docs/next/cli":"docs","docs/next/static-content":"docs","docs/0.3.x/strategies/amalgamation":"docs","docs/0.3.x/i18n/using":"docs","docs/0.1.x/integrations/actix-web":"docs","docs/0.3.x/plugins/security":"docs","docs/0.2.x/advanced/intro":"docs","docs/next/updating":"docs","docs/next/advanced/arch":"docs","docs/0.2.x/i18n/other-engines":"docs","docs/next/deploying/serverless":"docs","docs/i18n/other-engines":"docs","docs/next/define-app":"docs","docs/0.3.x/templates/setting-headers":"docs","docs/0.3.x/i18n/intro":"docs","docs/next/strategies/intro":"docs","docs/intro":"docs","docs/next/deploying/intro":"docs","docs/next/views":"docs","docs/0.3.x/testing/checkpoints":"docs","docs/0.2.x/templates/intro":"docs","docs/0.3.x/server-communication":"docs","docs/0.3.x/plugins/functional":"docs","docs/templates/intro":"docs","docs/0.1.x/cli":"docs","docs/deploying/exporting":"docs","docs/0.3.x/strategies/request-state":"docs","docs/next/plugins/using":"docs","docs/next/testing/intro":"docs","docs/0.1.x/strategies/request_state":"docs","docs/advanced/routing":"docs","docs/0.2.x/advanced/initial-loads":"docs","docs/next/templates/metadata-modification":"docs","docs/0.3.x/strategies/build-state":"docs","docs/next/hello-world":"docs","docs/next/debugging":"docs","docs/hello-world":"docs","docs/0.2.x/strategies/build-paths":"docs","docs/0.2.x/intro":"docs","docs/next/testing/fantoccini-basics":"docs","docs/0.1.x/arch":"docs","docs/0.2.x/testing/checkpoints":"docs"}';</script>
<script type="module">
    import init, { run } from "https://arctic-hen7.github.io/perseus/.perseus/bundle.js";
    async function main() {
        await init("https://arctic-hen7.github.io/perseus/.perseus/bundle.wasm");
        run();
    }
    main();
</script>
<!--PERSEUS_INTERPOLATED_HEAD_BEGINS--><title>Your Second App | Perseus Docs</title><link rel="stylesheet" href=".perseus/static/styles/markdown.css"/><link rel="stylesheet" href=".perseus/static/styles/docs_links_markdown.css"/><link rel="stylesheet" href=".perseus/static/prism.css"/>
<script>window.__PERSEUS_INITIAL_STATE = `{"title":"Your Second App","content":"<h1>Your Second App</h1>\\n<p>This section will cover building a more realistic app than the <em>Hello World!</em> section, with proper structuring and multiple templates.</p>\\n<p>If learning by reading isn't really your thing, or you'd like a reference, you can see all the code in <a href=\\"https://github.com/arctic-hen7/perseus/tree/main/examples/basic\\">this repository</a>!</p>\\n<h2>Setup</h2>\\n<p>Much like the <em>Hello World!</em> app, we'll start off by creating a new directory for the project, maybe <code>my-second-perseus-app</code> (or you could exercise imagination...). Then, we'll create a new <code>Cargo.toml</code> file and fill it with the following:</p>\\n<pre><code class=\\"language-toml\\">[package]\\nname = &quot;my-second-perseus-app&quot;\\nversion = &quot;0.1.0&quot;\\nedition = &quot;2018&quot;\\n\\n# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html\\n\\n[dependencies]\\nperseus = &quot;0.2&quot;\\nsycamore = &quot;0.6&quot;\\nserde = { version = &quot;1&quot;, features = [&quot;derive&quot;] }\\nserde_json = &quot;1&quot;\\n\\n</code></pre>\\n<p>The only difference between this and the last <code>Cargo.toml</code> we created is two new dependencies:</p>\\n<ul>\\n<li><a href=\\"https://serde.rs\\"><code>serde</code></a> -- a really useful Rust library for serializing/deserializing data</li>\\n<li><a href=\\"https://github.com/serde-rs/json\\"><code>serde_json</code></a> -- Serde's integration for JSON, which lets us pass around properties for more advanced pages in Perseus</li>\\n</ul>\\n<p>The next thing to do is to create <code>index.html</code>, which is pretty much the same as last time:</p>\\n<pre><code class=\\"language-html\\">&lt;!DOCTYPE html&gt;\\n&lt;html lang=&quot;en&quot;&gt;\\n    &lt;head&gt;\\n        &lt;meta charset=&quot;UTF-8&quot; /&gt;\\n        &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt;\\n    &lt;/head&gt;\\n    &lt;body&gt;\\n        &lt;div id=&quot;root&quot;&gt;&lt;/div&gt;\\n    &lt;/body&gt;\\n&lt;/html&gt;\\n\\n</code></pre>\\n<p>The only notable difference here is the absence of a <code>&lt;title&gt;</code>, which is because we'll be creating it inside Perseus! Any Perseus template can modify the <code>&lt;head&gt;</code> of the document, but anything you put into <code>index.html</code> will persist across all pages. We don't want to have conflicting titles, so we leave that property out of <code>index.html</code>.</p>\\n<h2><code>lib.rs</code></h2>\\n<p>As in every Perseus app, <code>lib.rs</code> is how we communicate with the CLI and tell it how our app works. Put the following content in <code>src/lib.rs</code>:</p>\\n<pre><code class=\\"language-rust,no_playground,no_run\\">mod error_pages;\\nmod templates;\\n\\nuse perseus::define_app;\\n\\ndefine_app! {\\n    templates: [\\n        crate::templates::index::get_template::&lt;G&gt;(),\\n        crate::templates::about::get_template::&lt;G&gt;()\\n    ],\\n    error_pages: crate::error_pages::get_error_pages(),\\n    static_aliases: {\\n        &quot;/test.txt&quot; =&gt; &quot;static/test.txt&quot;\\n    }\\n}\\n\\n</code></pre>\\n<p>This code is quite different from your first app, so let's go through how it works.</p>\\n<p>First, we define two other modules in our code: <code>error_pages</code> (at <code>src/error_pages.rs</code>) and <code>templates</code> (at <code>src/templates</code>). Don't worry, we'll create those in a moment. The rest of the code creates a new app with two templates, which are expected to be in the <code>src/templates</code> directory. Note the use of <code>&lt;G&gt;</code> here, which is a Rust <em>type parameter</em> (the <code>get_template</code> function can work for the browser or the server, so Rust needs to know which one it is). This parameter is <em>ambient</em> to the <code>templates</code> key, which means you can use it without declaring it as long as you're inside <code>templates: {...}</code>. This will be set to <code>DomNode</code> for the browser and <code>SsrNode</code> for the server, but that all happens behind the scenes.</p>\\n<p>Also note that we're pulling in our error pages from another file as well (in a larger app you may even want to have a different file for each error page).</p>\\n<p>The last thing we do is new, we define <code>static_aliases</code> to map the URL <code>/test.txt</code> in our app to the file <code>static/test.txt</code>. This feature is detailed in more depth later, but it can be extremely useful, for example for defining your site's logo (or favicon), which browsers expect to be available at <code>/favicon.ico</code>. Create the <code>static/test.txt</code> file now (<code>static/</code> should NOT be inside <code>src/</code>!) and fill it with whatever you want.</p>\\n<h2>Error Handling</h2>\\n<p>Before we get to the cool part of building the actual pages of the app, we should set up error pages again, which we'll do in <code>src/error_pages.rs</code>:</p>\\n<pre><code class=\\"language-rust\\">use perseus::{ErrorPages, GenericNode};\\nuse std::rc::Rc;\\nuse sycamore::template;\\n\\npub fn get_error_pages&lt;G: GenericNode&gt;() -&gt; ErrorPages&lt;G&gt; {\\n    let mut error_pages = ErrorPages::new(Rc::new(|url, status, err, _| {\\n        template! {\\n            p { (format!(&quot;An error with HTTP code {} occurred at '{}': '{}'.&quot;, status, url, err)) }\\n        }\\n    }));\\n    error_pages.add_page(\\n        404,\\n        Rc::new(|_, _, _, _| {\\n            template! {\\n                p { &quot;Page not found.&quot; }\\n            }\\n        }),\\n    );\\n\\n    error_pages\\n}\\n\\n</code></pre>\\n<p>This is a little more advanced than the last time we did this, and there are a few things we should note.</p>\\n<p>The first is the import of <code>GenericNode</code>, which we define as a type parameter on the <code>get_error_pages</code> function. As we said before, this means your error pages will work on the client or the server, and they're needed in both environments. If you're interested, this separation of browser and server elements is done by Sycamore, and you can learn more about it <a href=\\"https://docs.rs/sycamore/0.6/sycamore/generic_node/trait.GenericNode.html\\">here</a>.</p>\\n<p>In this function, we also define a different error page for a 404 error, which will occur when a user tries to go to a page that doesn't exist. The fallback page (which we initialize <code>ErrorPages</code> with) is the same as last time, and will be called for any errors other than a <em>404 Not Found</em>.</p>\\n<h2><code>index.rs</code></h2>\\n<p>It's time to create the first page for this app! But first, we need to make sure that import in <code>src/lib.rs</code> of <code>mod templates;</code> works, which requires us to create a new file <code>src/templates/mod.rs</code>, which declares <code>src/templates</code> as a module with its own code. Add the following to that file:</p>\\n<pre><code class=\\"language-rust\\">pub mod about;\\npub mod index;\\n\\n</code></pre>\\n<p>It's common practice to have a file for each <em>template</em>, which is slightly different to a page (explained in more detail later), and this app has two pages: a landing page (index) and an about page.</p>\\n<p>Let's begin with the landing page. Create a new file <code>src/templates/index.rs</code> and put the following inside:</p>\\n<pre><code class=\\"language-rust\\">use perseus::{\\n    http::header::{HeaderMap, HeaderName},\\n    GenericNode, StringResultWithCause, Template,\\n};\\nuse serde::{Deserialize, Serialize};\\nuse std::rc::Rc;\\nuse sycamore::prelude::{component, template, Template as SycamoreTemplate};\\n\\n#[derive(Serialize, Deserialize, Debug)]\\npub struct IndexPageProps {\\n    pub greeting: String,\\n}\\n\\n#[component(IndexPage&lt;G&gt;)]\\npub fn index_page(props: IndexPageProps) -&gt; SycamoreTemplate&lt;G&gt; {\\n    template! {\\n        p {(props.greeting)}\\n        a(href = &quot;/about&quot;, id = &quot;about-link&quot;) { &quot;About!&quot; }\\n    }\\n}\\n\\npub fn get_template&lt;G: GenericNode&gt;() -&gt; Template&lt;G&gt; {\\n    Template::new(&quot;index&quot;)\\n        .build_state_fn(Rc::new(get_build_props))\\n        .template(template_fn())\\n        .head(head_fn())\\n        .set_headers_fn(set_headers_fn())\\n}\\n\\npub async fn get_build_props(_path: String) -&gt; StringResultWithCause&lt;String&gt; {\\n    Ok(serde_json::to_string(&amp;IndexPageProps {\\n        greeting: &quot;Hello World!&quot;.to_string(),\\n    })\\n    .unwrap())\\n}\\n\\npub fn template_fn&lt;G: GenericNode&gt;() -&gt; perseus::template::TemplateFn&lt;G&gt; {\\n    Rc::new(|props: Option&lt;String&gt;| {\\n        template! {\\n            IndexPage(\\n                serde_json::from_str::&lt;IndexPageProps&gt;(&amp;props.unwrap()).unwrap()\\n            )\\n        }\\n    })\\n}\\n\\npub fn head_fn() -&gt; perseus::template::HeadFn {\\n    Rc::new(|_| {\\n        template! {\\n            title { &quot;Index Page | Perseus Example – Basic&quot; }\\n        }\\n    })\\n}\\n\\npub fn set_headers_fn() -&gt; perseus::template::SetHeadersFn {\\n    Rc::new(|_| {\\n        let mut map = HeaderMap::new();\\n        map.insert(\\n            HeaderName::from_lowercase(b&quot;x-test&quot;).unwrap(),\\n            &quot;custom value&quot;.parse().unwrap(),\\n        );\\n        map\\n    })\\n}\\n\\n</code></pre>\\n<p>This code is <em>much</em> more complex than the <em>Hello World!</em> example, so let's go through it carefully.</p>\\n<p>First, we import a whole ton of stuff:</p>\\n<ul>\\n<li><code>perseus</code>\\n<ul>\\n<li><code>StringResultWithCause</code> -- see below for an explanation of this</li>\\n<li><code>Template</code> -- as before</li>\\n<li><code>GenericNode</code> -- as before</li>\\n</ul>\\n</li>\\n<li><code>serde</code>\\n<ul>\\n<li><code>Serialize</code> -- a trait for <code>struct</code>s that can be turned into a string (like JSON)</li>\\n<li><code>Deserialize</code> -- a trait for <code>struct</code>s that can be <em>de</em>serialized from a string (like JSON)</li>\\n</ul>\\n</li>\\n<li><code>std::rc::Rc</code> -- same as before, you can read more about <code>Rc</code>s <a href=\\"https://doc.rust-lang.org/std/rc/struct.Rc.html\\">here</a></li>\\n<li><code>sycamore</code>\\n<ul>\\n<li><code>component</code> -- a macro that turns a function into a Sycamore component</li>\\n<li><code>template</code> -- the <code>template!</code> macro, same as before</li>\\n<li><code>Template as SycamoreTemplate</code> -- the output of the <code>template!</code> macro, aliased as <code>SycamoreTemplate</code> so it doesn't conflict with <code>perseus::Template</code>, which is very different</li>\\n</ul>\\n</li>\\n</ul>\\n<p>Then we define a number of different functions and a <code>struct</code>, each of which gets a section now.</p>\\n<h3><code>IndexPageProps</code></h3>\\n<p>This <code>struct</code> represents the properties that the index page will take. In this case, we're building an index page that will display a greeting defined in this, specifically in the <code>greeting</code> property.</p>\\n<p>Any template can take arguments in Perseus, which should always be given inside a <code>struct</code>. For simplicity and performance, Perseus only ever passes your properties around as a <code>String</code>, so you'll need to serialize/deserialize them yourself (as in the functions below).</p>\\n<h3><code>index_page()</code></h3>\\n<p>This is the actual component that your page is. Technically, you could just put this under <code>template_fn()</code>, but it's conventional to break it out independently. By annotating it with <code>#[component(IndexPage&lt;G&gt;)]</code>, we tell Sycamore to turn it into a complex <code>struct</code> that can be called inside <code>template!</code> (which we do in <code>template_fn()</code>).</p>\\n<p>Note that this takes <code>IndexPageProps</code> as an argument, which it can then access in the <code>template!</code>. This is Sycamore's interpolation system, which you can read about <a href=\\"https://sycamore-rs.netlify.app/docs/basics/template\\">here</a>, but all you need to know is that it's basically seamless and works exactly as you'd expect.</p>\\n<p>The only other thing we do here is define an <code>&lt;a&gt;</code> (an HTML link) to <code>/about</code>. This link, and any others you define, will automatically be detected by Sycamore's systems, which will pass them to Perseus' routing logic, which means your users <strong>never leave the page</strong>. In this way, Perseus only pulls in the content that needs to change, and gives your users the feeling of a lightning-fast and weightless app.</p>\\n<p><em>Note: external links will automatically be excluded from this, and you can exclude manually by adding <code>rel=&quot;external&quot;</code> if you need.</em></p>\\n<h3><code>get_template()</code></h3>\\n<p>This function is what we call in <code>lib.rs</code>, and it combines everything else in this file to produce an actual Perseus <code>Template</code> to be used. Note the name of the template as <code>index</code>, which Perseus interprets as special, which causes this template to be rendered at <code>/</code> (the landing page).</p>\\n<p>Perseus' templating system is extremely versatile, and here we're using it to define our page itself through <code>.template()</code>, and to define a function that will modify the document <code>&lt;head&gt;</code> (which allows us to add a title) with <code>.head()</code>. Notably, we also use the <em>build state</em> rendering strategy, which tells Perseus to call the <code>get_build_props()</code> function when your app builds to get some state. More on that now.</p>\\n<h3><code>get_build_props()</code></h3>\\n<p>This function is part of Perseus' secret sauce (actually <em>open</em> sauce), and it will be called when the CLI builds your app to create properties that the template will take (it expects a string, hence the serialization). Here, we just hard-code a greeting in to be used, but the real power of this comes when you start using the fact that this function is <code>async</code>. You might query a database to get a list of blog posts, or pull in a Markdown documentation page and parse it, the possibilities are endless!</p>\\n<p>Note that this function returns a <code>StringResultWithCause&lt;String&gt;</code>, which means that it returns a normal Rust <code>Result&lt;String, E&gt;</code>, where <code>E</code> is a tuple of a <code>String</code> error message and a declaration of who caused the error (either the client or the server). This becomes important when you combine this rendering strategy with others, which are explained in depth later in the book.</p>\\n<h3><code>template_fn()</code></h3>\\n<p>The result of this function is what Perseus will call when it wants to render your template (which it does more than you might think), and it passes it the props that your template takes as an <code>Option&lt;String&gt;</code>. This might seem a bit weird, but there are reasons under the hood. All you need to know here is that if your template takes any properties, they <strong>will</strong> be here, and it's safe to <code>.unwrap()</code> them for deserialization.</p>\\n<h3><code>head_fn()</code></h3>\\n<p>This is very similar to <code>template_fn</code>, except it can't be reactive. In other words, anything you put in here is like a picture, it can't move (so no buttons, counters, etc.). This is because this modifies the document <code>&lt;head&gt;</code>, so you should put metadata, titles, etc. in here. Note that the function we return from here does take an argument (ignored with <code>_</code>), that's a string of the properties to your app, but we don't need it in this example. If this page was a generic template for blog posts, you might use this capability to render a different title for each blog post.</p>\\n<p>All this does though is set the <code>&lt;title&gt;</code>. If you inspect the source code of the HTML in your browser, you'll find a big comment in the <code>&lt;head&gt;</code> that says <code>&lt;!--PERSEUS_INTERPOLATED_HEAD_BEGINS--&gt;</code>, that separates the stuff that should remain the same on every page from the stuff that should update for each page.</p>\\n<h2><code>about.rs</code></h2>\\n<p>Okay! We're past the hump, and now it's time to define the (much simpler) <code>/about</code> page. Create <code>src/templates/about.rs</code> and put the following inside:</p>\\n<pre><code class=\\"language-rust\\">use perseus::Template;\\nuse std::rc::Rc;\\nuse sycamore::prelude::{component, template, GenericNode, Template as SycamoreTemplate};\\n\\n#[component(AboutPage&lt;G&gt;)]\\npub fn about_page() -&gt; SycamoreTemplate&lt;G&gt; {\\n    template! {\\n        p { &quot;About.&quot; }\\n    }\\n}\\n\\npub fn get_template&lt;G: GenericNode&gt;() -&gt; Template&lt;G&gt; {\\n    Template::new(&quot;about&quot;)\\n        .template(template_fn())\\n        .head(head_fn())\\n}\\n\\npub fn template_fn&lt;G: GenericNode&gt;() -&gt; perseus::template::TemplateFn&lt;G&gt; {\\n    Rc::new(|_| {\\n        template! {\\n            AboutPage()\\n        }\\n    })\\n}\\n\\npub fn head_fn() -&gt; perseus::template::HeadFn {\\n    Rc::new(|_| {\\n        template! {\\n            title { &quot;About Page | Perseus Example – Basic&quot; }\\n        }\\n    })\\n}\\n\\n</code></pre>\\n<p>This is basically exactly the same as <code>index.rs</code>, except we don't have any properties to deal with, and we don't need to generate anything special at build time (but Perseus will still render this page to static HTML, ready to be served to your users).</p>\\n<h2>Running It</h2>\\n<p><code>perseus serve</code></p>\\n<p>That's all. Every time you build a Perseus app, that's all you need to do.</p>\\n<p>Once this is finished, your app will be live at <a href=\\"http://localhost:8080\\">http://localhost:8080</a>! Note that if you don't like that, you can change the host/port with the <code>HOST</code>/<code>PORT</code> environment variables (e.g. you'd want to set the host to <code>0.0.0.0</code> if you want other people on your network to be able to access your site).</p>\\n<p>Hop over to <a href=\\"http://localhost:8080\\">http://localhost:8080</a> in any modern browser and you should see your greeting <code>Hello World!</code> above a link to the about page! if you click that link, you'll be taken to a page that just says <code>About.</code>, but notice how your browser seemingly never navigates to a new page (the tab doesn't show a loading icon)? That's Perseus' <em>app shell</em> in action, which intercepts navigation to other pages and makes it occur seamlessly, only fetching the bare minimum to make the new page load. The same behavior will occur if you use your browser's forward/backward buttons.</p>\\n<details>\\n<summary>Why a 'modern browser'?</summary>\\n<h3>Browser Compatibility</h3>\\n<p>Perseus is compatible with any browser that supports Wasm, which is most modern browsers like Firefox and Chrome. However, legacy browsers like Internet Explorer will not work with any Perseus app, unless you <em>polyfill</em> support for WebAssembly.</p>\\n</details>\\n<p>By the way, remember this little bit of code in <code>src/lib.rs</code>?</p>\\n<pre><code class=\\"language-rust\\">    static_aliases: {\\n        &quot;/test.txt&quot; =&gt; &quot;static/test.txt&quot;\\n    }\\n</code></pre>\\n<p>If you navigate to <a href=\\"http://localhost:8080/test.txt\\">http://localhost:8080/test.txt</a>, you should see the contents on <code>static/test.txt</code>! You can also access them at <a href=\\"http://localhost:8080/.perseus/static/test.txt\\">http://localhost:8080/.perseus/static/test.txt</a></p>\\n<h2>Moving Forward</h2>\\n<p>Congratulations! You're now well on your way to building highly performant web apps in Rust! The remaining sections of this book are more reference-style, and won't guide you through building an app, but they'll focus instead on specific features of Perseus that can be used to make extremely powerful systems.</p>\\n<p>So go forth, and build!</p>\\n","sidebar_content":"<h1>Introduction</h1>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/intro\\">Introduction</a>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/what-is-perseus\\">What is Perseus?</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/hello-world\\">Hello World!</a></li>\\n</ul>\\n</li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/second-app\\">Your Second App</a></li>\\n</ul>\\n<hr />\\n<h1>Reference</h1>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/define-app\\"><code>define_app!</code></a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/views\\">Writing Views</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/debugging\\">Debugging</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/templates/intro\\">Templates and Routing</a>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/templates/metadata-modification\\">Modifying the <code>&lt;head&gt;</code></a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/templates/setting-headers\\">Modifying HTTP Headers</a></li>\\n</ul>\\n</li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/error-pages\\">Error Pages</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/static-content\\">Static Content</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/i18n/intro\\">Internationalization</a>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/i18n/defining\\">Defining Translations</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/i18n/using\\">Using Translations</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/i18n/translations-managers\\">Translations Managers</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/i18n/other-engines\\">Other Translation Engines</a></li>\\n</ul>\\n</li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/strategies/intro\\">Rendering Strategies</a>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/strategies/build-state\\">Build State</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/strategies/build-paths\\">Build Paths</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/strategies/request-state\\">Request State</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/strategies/revalidation\\">Revalidation</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/strategies/incremental\\">Incremental Generation</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/strategies/amalgamation\\">State Amalgamation</a></li>\\n</ul>\\n</li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/cli\\">CLI</a>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/ejecting\\">Ejecting</a></li>\\n</ul>\\n</li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/config-managers\\">Config Managers</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/testing/intro\\">Testing</a>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/testing/checkpoints\\">Checkpoints</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/testing/fantoccini-basics\\">Fantoccini Basics</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/testing/manual\\">Manual Testing</a></li>\\n</ul>\\n</li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/styling\\">Styling</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/deploying/intro\\">Deploying</a>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/deploying/exporting\\">Static Exporting</a></li>\\n<li><a href=\\"\\">Server Deployment</a></li>\\n<li><a href=\\"\\">Serverless Deployment</a></li>\\n</ul>\\n</li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/updating\\">Migrating from v0.1.x</a></li>\\n</ul>\\n<hr />\\n<h1>Advanced</h1>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/advanced/intro\\">Under the Hood</a>\\n<ul>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/advanced/arch\\">Architecture</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/advanced/initial-loads\\">Initial Loads</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/advanced/subsequent-loads\\">Subsequent Loads</a></li>\\n<li><a href=\\"https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/advanced/routing\\">Routing</a></li>\\n</ul>\\n</li>\\n</ul>\\n","status":"Stable","manifest":{"stable":"0.2.x","outdated":["0.1.x"],"beta":["0.3.x"],"history_map":{"0.3.x":"HEAD","0.1.x":"v0.1.4","0.2.x":"v0.2.3"}},"current_version":"0.2.x"}`;</script>
</head>
    <body class="bg-white dark:bg-navy">
        <div id="root"><div id="__perseus_content_initial" class="__perseus_content"><header class="shadow-md sm:p-2 w-full bg-white dark:text-white dark:bg-navy mb-20"><div class="flex justify-between"><a href="en-US/" class="justify-self-start self-center m-3 ml-5 text-md sm:text-2xl">Perseus</a><div class="md:hidden m-3 mr-5 tham tham-e-spin tham-w-6 "><div class="tham-box"><div class="dark:bg-white tham-inner"></div></div></div><nav class="hidden md:flex"><ul class="mr-5 flex"><li class="m-3 p-1"><a href="en-US/docs" class="px-2">Docs</a></li><li class="m-3 p-1"><a class="px-2" href="en-US/comparisons">Comparisons</a></li></ul></nav></div><nav class="md:hidden w-full text-center justify-center overflow-y-scroll hidden" id="mobile_nav_menu"><div class="mr-5 overflow-y-scroll" style="max-height: 500px"><ul><li class="m-3 p-1"><a class="px-2" href="en-US/docs">Docs</a></li><li class="m-3 p-1"><a href="en-US/comparisons" class="px-2">Comparisons</a></li></ul><hr/><div class="text-left p-3"><!----><select class="p-1 rounded-sm dark:bg-navy"><option value="next">Next (unreleased)</option><option value="0.3.x">v⁨0.3.x⁩ (beta)</option><option selected="" value="0.2.x">v⁨0.2.x⁩ (stable)</option><option value="0.1.x">v⁨0.1.x⁩ (outdated)</option></select><div class="docs-links-markdown"><h1>Introduction</h1>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/intro">Introduction</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/what-is-perseus">What is Perseus?</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/hello-world">Hello World!</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/second-app">Your Second App</a></li>
</ul>
<hr />
<h1>Reference</h1>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/define-app"><code>define_app!</code></a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/views">Writing Views</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/debugging">Debugging</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/templates/intro">Templates and Routing</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/templates/metadata-modification">Modifying the <code>&lt;head&gt;</code></a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/templates/setting-headers">Modifying HTTP Headers</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/error-pages">Error Pages</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/static-content">Static Content</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/i18n/intro">Internationalization</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/i18n/defining">Defining Translations</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/i18n/using">Using Translations</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/i18n/translations-managers">Translations Managers</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/i18n/other-engines">Other Translation Engines</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/strategies/intro">Rendering Strategies</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/strategies/build-state">Build State</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/strategies/build-paths">Build Paths</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/strategies/request-state">Request State</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/strategies/revalidation">Revalidation</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/strategies/incremental">Incremental Generation</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/strategies/amalgamation">State Amalgamation</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/cli">CLI</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/ejecting">Ejecting</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/config-managers">Config Managers</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/testing/intro">Testing</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/testing/checkpoints">Checkpoints</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/testing/fantoccini-basics">Fantoccini Basics</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/testing/manual">Manual Testing</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/styling">Styling</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/deploying/intro">Deploying</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/deploying/exporting">Static Exporting</a></li>
<li><a href="">Server Deployment</a></li>
<li><a href="">Serverless Deployment</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/updating">Migrating from v0.1.x</a></li>
</ul>
<hr />
<h1>Advanced</h1>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/advanced/intro">Under the Hood</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/advanced/arch">Architecture</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/advanced/initial-loads">Initial Loads</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/advanced/subsequent-loads">Subsequent Loads</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/advanced/routing">Routing</a></li>
</ul>
</li>
</ul>
</div></div></div></nav></header><div class="mt-14 xs:mt-16 sm:mt-20 lg:mt-25 overflow-y-auto flex"><div class="flex w-full"><div class="h-full hidden md:block max-w-xs w-full border-r"><div class="mr-5"><div class="text-left text-black dark:text-white p-3"><aside><!----><select class="p-1 rounded-sm dark:bg-navy"><option value="next">Next (unreleased)</option><option value="0.3.x">v⁨0.3.x⁩ (beta)</option><option selected="" value="0.2.x">v⁨0.2.x⁩ (stable)</option><option value="0.1.x">v⁨0.1.x⁩ (outdated)</option></select><div class="docs-links-markdown"><h1>Introduction</h1>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/intro">Introduction</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/what-is-perseus">What is Perseus?</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/hello-world">Hello World!</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/second-app">Your Second App</a></li>
</ul>
<hr />
<h1>Reference</h1>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/define-app"><code>define_app!</code></a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/views">Writing Views</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/debugging">Debugging</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/templates/intro">Templates and Routing</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/templates/metadata-modification">Modifying the <code>&lt;head&gt;</code></a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/templates/setting-headers">Modifying HTTP Headers</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/error-pages">Error Pages</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/static-content">Static Content</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/i18n/intro">Internationalization</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/i18n/defining">Defining Translations</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/i18n/using">Using Translations</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/i18n/translations-managers">Translations Managers</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/i18n/other-engines">Other Translation Engines</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/strategies/intro">Rendering Strategies</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/strategies/build-state">Build State</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/strategies/build-paths">Build Paths</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/strategies/request-state">Request State</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/strategies/revalidation">Revalidation</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/strategies/incremental">Incremental Generation</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/strategies/amalgamation">State Amalgamation</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/cli">CLI</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/ejecting">Ejecting</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/config-managers">Config Managers</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/testing/intro">Testing</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/testing/checkpoints">Checkpoints</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/testing/fantoccini-basics">Fantoccini Basics</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/testing/manual">Manual Testing</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/styling">Styling</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/deploying/intro">Deploying</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/deploying/exporting">Static Exporting</a></li>
<li><a href="">Server Deployment</a></li>
<li><a href="">Serverless Deployment</a></li>
</ul>
</li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/updating">Migrating from v0.1.x</a></li>
</ul>
<hr />
<h1>Advanced</h1>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/advanced/intro">Under the Hood</a>
<ul>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/advanced/arch">Architecture</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/advanced/initial-loads">Initial Loads</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/advanced/subsequent-loads">Subsequent Loads</a></li>
<li><a href="https://arctic-hen7.github.io/perseus/en-US/docs/0.2.x/advanced/routing">Routing</a></li>
</ul>
</li>
</ul>
</div></aside></div></div></div><div class="h-full flex w-full"><div class="px-3 w-full sm:mr-auto sm:ml-auto sm:max-w-prose lg:max-w-3xl xl:max-w-4xl 2xl:max-w-5xl"><!----><main class="text-black dark:text-white"><div class="markdown"><h1>Your Second App</h1>
<p>This section will cover building a more realistic app than the <em>Hello World!</em> section, with proper structuring and multiple templates.</p>
<p>If learning by reading isn't really your thing, or you'd like a reference, you can see all the code in <a href="https://github.com/arctic-hen7/perseus/tree/main/examples/basic">this repository</a>!</p>
<h2>Setup</h2>
<p>Much like the <em>Hello World!</em> app, we'll start off by creating a new directory for the project, maybe <code>my-second-perseus-app</code> (or you could exercise imagination...). Then, we'll create a new <code>Cargo.toml</code> file and fill it with the following:</p>
<pre><code class="language-toml">[package]
name = &quot;my-second-perseus-app&quot;
version = &quot;0.1.0&quot;
edition = &quot;2018&quot;

# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html

[dependencies]
perseus = &quot;0.2&quot;
sycamore = &quot;0.6&quot;
serde = { version = &quot;1&quot;, features = [&quot;derive&quot;] }
serde_json = &quot;1&quot;

</code></pre>
<p>The only difference between this and the last <code>Cargo.toml</code> we created is two new dependencies:</p>
<ul>
<li><a href="https://serde.rs"><code>serde</code></a> -- a really useful Rust library for serializing/deserializing data</li>
<li><a href="https://github.com/serde-rs/json"><code>serde_json</code></a> -- Serde's integration for JSON, which lets us pass around properties for more advanced pages in Perseus</li>
</ul>
<p>The next thing to do is to create <code>index.html</code>, which is pretty much the same as last time:</p>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
    &lt;head&gt;
        &lt;meta charset=&quot;UTF-8&quot; /&gt;
        &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div id=&quot;root&quot;&gt;&lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;

</code></pre>
<p>The only notable difference here is the absence of a <code>&lt;title&gt;</code>, which is because we'll be creating it inside Perseus! Any Perseus template can modify the <code>&lt;head&gt;</code> of the document, but anything you put into <code>index.html</code> will persist across all pages. We don't want to have conflicting titles, so we leave that property out of <code>index.html</code>.</p>
<h2><code>lib.rs</code></h2>
<p>As in every Perseus app, <code>lib.rs</code> is how we communicate with the CLI and tell it how our app works. Put the following content in <code>src/lib.rs</code>:</p>
<pre><code class="language-rust,no_playground,no_run">mod error_pages;
mod templates;

use perseus::define_app;

define_app! {
    templates: [
        crate::templates::index::get_template::&lt;G&gt;(),
        crate::templates::about::get_template::&lt;G&gt;()
    ],
    error_pages: crate::error_pages::get_error_pages(),
    static_aliases: {
        &quot;/test.txt&quot; =&gt; &quot;static/test.txt&quot;
    }
}

</code></pre>
<p>This code is quite different from your first app, so let's go through how it works.</p>
<p>First, we define two other modules in our code: <code>error_pages</code> (at <code>src/error_pages.rs</code>) and <code>templates</code> (at <code>src/templates</code>). Don't worry, we'll create those in a moment. The rest of the code creates a new app with two templates, which are expected to be in the <code>src/templates</code> directory. Note the use of <code>&lt;G&gt;</code> here, which is a Rust <em>type parameter</em> (the <code>get_template</code> function can work for the browser or the server, so Rust needs to know which one it is). This parameter is <em>ambient</em> to the <code>templates</code> key, which means you can use it without declaring it as long as you're inside <code>templates: {...}</code>. This will be set to <code>DomNode</code> for the browser and <code>SsrNode</code> for the server, but that all happens behind the scenes.</p>
<p>Also note that we're pulling in our error pages from another file as well (in a larger app you may even want to have a different file for each error page).</p>
<p>The last thing we do is new, we define <code>static_aliases</code> to map the URL <code>/test.txt</code> in our app to the file <code>static/test.txt</code>. This feature is detailed in more depth later, but it can be extremely useful, for example for defining your site's logo (or favicon), which browsers expect to be available at <code>/favicon.ico</code>. Create the <code>static/test.txt</code> file now (<code>static/</code> should NOT be inside <code>src/</code>!) and fill it with whatever you want.</p>
<h2>Error Handling</h2>
<p>Before we get to the cool part of building the actual pages of the app, we should set up error pages again, which we'll do in <code>src/error_pages.rs</code>:</p>
<pre><code class="language-rust">use perseus::{ErrorPages, GenericNode};
use std::rc::Rc;
use sycamore::template;

pub fn get_error_pages&lt;G: GenericNode&gt;() -&gt; ErrorPages&lt;G&gt; {
    let mut error_pages = ErrorPages::new(Rc::new(|url, status, err, _| {
        template! {
            p { (format!(&quot;An error with HTTP code {} occurred at '{}': '{}'.&quot;, status, url, err)) }
        }
    }));
    error_pages.add_page(
        404,
        Rc::new(|_, _, _, _| {
            template! {
                p { &quot;Page not found.&quot; }
            }
        }),
    );

    error_pages
}

</code></pre>
<p>This is a little more advanced than the last time we did this, and there are a few things we should note.</p>
<p>The first is the import of <code>GenericNode</code>, which we define as a type parameter on the <code>get_error_pages</code> function. As we said before, this means your error pages will work on the client or the server, and they're needed in both environments. If you're interested, this separation of browser and server elements is done by Sycamore, and you can learn more about it <a href="https://docs.rs/sycamore/0.6/sycamore/generic_node/trait.GenericNode.html">here</a>.</p>
<p>In this function, we also define a different error page for a 404 error, which will occur when a user tries to go to a page that doesn't exist. The fallback page (which we initialize <code>ErrorPages</code> with) is the same as last time, and will be called for any errors other than a <em>404 Not Found</em>.</p>
<h2><code>index.rs</code></h2>
<p>It's time to create the first page for this app! But first, we need to make sure that import in <code>src/lib.rs</code> of <code>mod templates;</code> works, which requires us to create a new file <code>src/templates/mod.rs</code>, which declares <code>src/templates</code> as a module with its own code. Add the following to that file:</p>
<pre><code class="language-rust">pub mod about;
pub mod index;

</code></pre>
<p>It's common practice to have a file for each <em>template</em>, which is slightly different to a page (explained in more detail later), and this app has two pages: a landing page (index) and an about page.</p>
<p>Let's begin with the landing page. Create a new file <code>src/templates/index.rs</code> and put the following inside:</p>
<pre><code class="language-rust">use perseus::{
    http::header::{HeaderMap, HeaderName},
    GenericNode, StringResultWithCause, Template,
};
use serde::{Deserialize, Serialize};
use std::rc::Rc;
use sycamore::prelude::{component, template, Template as SycamoreTemplate};

#[derive(Serialize, Deserialize, Debug)]
pub struct IndexPageProps {
    pub greeting: String,
}

#[component(IndexPage&lt;G&gt;)]
pub fn index_page(props: IndexPageProps) -&gt; SycamoreTemplate&lt;G&gt; {
    template! {
        p {(props.greeting)}
        a(href = &quot;/about&quot;, id = &quot;about-link&quot;) { &quot;About!&quot; }
    }
}

pub fn get_template&lt;G: GenericNode&gt;() -&gt; Template&lt;G&gt; {
    Template::new(&quot;index&quot;)
        .build_state_fn(Rc::new(get_build_props))
        .template(template_fn())
        .head(head_fn())
        .set_headers_fn(set_headers_fn())
}

pub async fn get_build_props(_path: String) -&gt; StringResultWithCause&lt;String&gt; {
    Ok(serde_json::to_string(&amp;IndexPageProps {
        greeting: &quot;Hello World!&quot;.to_string(),
    })
    .unwrap())
}

pub fn template_fn&lt;G: GenericNode&gt;() -&gt; perseus::template::TemplateFn&lt;G&gt; {
    Rc::new(|props: Option&lt;String&gt;| {
        template! {
            IndexPage(
                serde_json::from_str::&lt;IndexPageProps&gt;(&amp;props.unwrap()).unwrap()
            )
        }
    })
}

pub fn head_fn() -&gt; perseus::template::HeadFn {
    Rc::new(|_| {
        template! {
            title { &quot;Index Page | Perseus Example – Basic&quot; }
        }
    })
}

pub fn set_headers_fn() -&gt; perseus::template::SetHeadersFn {
    Rc::new(|_| {
        let mut map = HeaderMap::new();
        map.insert(
            HeaderName::from_lowercase(b&quot;x-test&quot;).unwrap(),
            &quot;custom value&quot;.parse().unwrap(),
        );
        map
    })
}

</code></pre>
<p>This code is <em>much</em> more complex than the <em>Hello World!</em> example, so let's go through it carefully.</p>
<p>First, we import a whole ton of stuff:</p>
<ul>
<li><code>perseus</code>
<ul>
<li><code>StringResultWithCause</code> -- see below for an explanation of this</li>
<li><code>Template</code> -- as before</li>
<li><code>GenericNode</code> -- as before</li>
</ul>
</li>
<li><code>serde</code>
<ul>
<li><code>Serialize</code> -- a trait for <code>struct</code>s that can be turned into a string (like JSON)</li>
<li><code>Deserialize</code> -- a trait for <code>struct</code>s that can be <em>de</em>serialized from a string (like JSON)</li>
</ul>
</li>
<li><code>std::rc::Rc</code> -- same as before, you can read more about <code>Rc</code>s <a href="https://doc.rust-lang.org/std/rc/struct.Rc.html">here</a></li>
<li><code>sycamore</code>
<ul>
<li><code>component</code> -- a macro that turns a function into a Sycamore component</li>
<li><code>template</code> -- the <code>template!</code> macro, same as before</li>
<li><code>Template as SycamoreTemplate</code> -- the output of the <code>template!</code> macro, aliased as <code>SycamoreTemplate</code> so it doesn't conflict with <code>perseus::Template</code>, which is very different</li>
</ul>
</li>
</ul>
<p>Then we define a number of different functions and a <code>struct</code>, each of which gets a section now.</p>
<h3><code>IndexPageProps</code></h3>
<p>This <code>struct</code> represents the properties that the index page will take. In this case, we're building an index page that will display a greeting defined in this, specifically in the <code>greeting</code> property.</p>
<p>Any template can take arguments in Perseus, which should always be given inside a <code>struct</code>. For simplicity and performance, Perseus only ever passes your properties around as a <code>String</code>, so you'll need to serialize/deserialize them yourself (as in the functions below).</p>
<h3><code>index_page()</code></h3>
<p>This is the actual component that your page is. Technically, you could just put this under <code>template_fn()</code>, but it's conventional to break it out independently. By annotating it with <code>#[component(IndexPage&lt;G&gt;)]</code>, we tell Sycamore to turn it into a complex <code>struct</code> that can be called inside <code>template!</code> (which we do in <code>template_fn()</code>).</p>
<p>Note that this takes <code>IndexPageProps</code> as an argument, which it can then access in the <code>template!</code>. This is Sycamore's interpolation system, which you can read about <a href="https://sycamore-rs.netlify.app/docs/basics/template">here</a>, but all you need to know is that it's basically seamless and works exactly as you'd expect.</p>
<p>The only other thing we do here is define an <code>&lt;a&gt;</code> (an HTML link) to <code>/about</code>. This link, and any others you define, will automatically be detected by Sycamore's systems, which will pass them to Perseus' routing logic, which means your users <strong>never leave the page</strong>. In this way, Perseus only pulls in the content that needs to change, and gives your users the feeling of a lightning-fast and weightless app.</p>
<p><em>Note: external links will automatically be excluded from this, and you can exclude manually by adding <code>rel=&quot;external&quot;</code> if you need.</em></p>
<h3><code>get_template()</code></h3>
<p>This function is what we call in <code>lib.rs</code>, and it combines everything else in this file to produce an actual Perseus <code>Template</code> to be used. Note the name of the template as <code>index</code>, which Perseus interprets as special, which causes this template to be rendered at <code>/</code> (the landing page).</p>
<p>Perseus' templating system is extremely versatile, and here we're using it to define our page itself through <code>.template()</code>, and to define a function that will modify the document <code>&lt;head&gt;</code> (which allows us to add a title) with <code>.head()</code>. Notably, we also use the <em>build state</em> rendering strategy, which tells Perseus to call the <code>get_build_props()</code> function when your app builds to get some state. More on that now.</p>
<h3><code>get_build_props()</code></h3>
<p>This function is part of Perseus' secret sauce (actually <em>open</em> sauce), and it will be called when the CLI builds your app to create properties that the template will take (it expects a string, hence the serialization). Here, we just hard-code a greeting in to be used, but the real power of this comes when you start using the fact that this function is <code>async</code>. You might query a database to get a list of blog posts, or pull in a Markdown documentation page and parse it, the possibilities are endless!</p>
<p>Note that this function returns a <code>StringResultWithCause&lt;String&gt;</code>, which means that it returns a normal Rust <code>Result&lt;String, E&gt;</code>, where <code>E</code> is a tuple of a <code>String</code> error message and a declaration of who caused the error (either the client or the server). This becomes important when you combine this rendering strategy with others, which are explained in depth later in the book.</p>
<h3><code>template_fn()</code></h3>
<p>The result of this function is what Perseus will call when it wants to render your template (which it does more than you might think), and it passes it the props that your template takes as an <code>Option&lt;String&gt;</code>. This might seem a bit weird, but there are reasons under the hood. All you need to know here is that if your template takes any properties, they <strong>will</strong> be here, and it's safe to <code>.unwrap()</code> them for deserialization.</p>
<h3><code>head_fn()</code></h3>
<p>This is very similar to <code>template_fn</code>, except it can't be reactive. In other words, anything you put in here is like a picture, it can't move (so no buttons, counters, etc.). This is because this modifies the document <code>&lt;head&gt;</code>, so you should put metadata, titles, etc. in here. Note that the function we return from here does take an argument (ignored with <code>_</code>), that's a string of the properties to your app, but we don't need it in this example. If this page was a generic template for blog posts, you might use this capability to render a different title for each blog post.</p>
<p>All this does though is set the <code>&lt;title&gt;</code>. If you inspect the source code of the HTML in your browser, you'll find a big comment in the <code>&lt;head&gt;</code> that says <code>&lt;!--PERSEUS_INTERPOLATED_HEAD_BEGINS--&gt;</code>, that separates the stuff that should remain the same on every page from the stuff that should update for each page.</p>
<h2><code>about.rs</code></h2>
<p>Okay! We're past the hump, and now it's time to define the (much simpler) <code>/about</code> page. Create <code>src/templates/about.rs</code> and put the following inside:</p>
<pre><code class="language-rust">use perseus::Template;
use std::rc::Rc;
use sycamore::prelude::{component, template, GenericNode, Template as SycamoreTemplate};

#[component(AboutPage&lt;G&gt;)]
pub fn about_page() -&gt; SycamoreTemplate&lt;G&gt; {
    template! {
        p { &quot;About.&quot; }
    }
}

pub fn get_template&lt;G: GenericNode&gt;() -&gt; Template&lt;G&gt; {
    Template::new(&quot;about&quot;)
        .template(template_fn())
        .head(head_fn())
}

pub fn template_fn&lt;G: GenericNode&gt;() -&gt; perseus::template::TemplateFn&lt;G&gt; {
    Rc::new(|_| {
        template! {
            AboutPage()
        }
    })
}

pub fn head_fn() -&gt; perseus::template::HeadFn {
    Rc::new(|_| {
        template! {
            title { &quot;About Page | Perseus Example – Basic&quot; }
        }
    })
}

</code></pre>
<p>This is basically exactly the same as <code>index.rs</code>, except we don't have any properties to deal with, and we don't need to generate anything special at build time (but Perseus will still render this page to static HTML, ready to be served to your users).</p>
<h2>Running It</h2>
<p><code>perseus serve</code></p>
<p>That's all. Every time you build a Perseus app, that's all you need to do.</p>
<p>Once this is finished, your app will be live at <a href="http://localhost:8080">http://localhost:8080</a>! Note that if you don't like that, you can change the host/port with the <code>HOST</code>/<code>PORT</code> environment variables (e.g. you'd want to set the host to <code>0.0.0.0</code> if you want other people on your network to be able to access your site).</p>
<p>Hop over to <a href="http://localhost:8080">http://localhost:8080</a> in any modern browser and you should see your greeting <code>Hello World!</code> above a link to the about page! if you click that link, you'll be taken to a page that just says <code>About.</code>, but notice how your browser seemingly never navigates to a new page (the tab doesn't show a loading icon)? That's Perseus' <em>app shell</em> in action, which intercepts navigation to other pages and makes it occur seamlessly, only fetching the bare minimum to make the new page load. The same behavior will occur if you use your browser's forward/backward buttons.</p>
<details>
<summary>Why a 'modern browser'?</summary>
<h3>Browser Compatibility</h3>
<p>Perseus is compatible with any browser that supports Wasm, which is most modern browsers like Firefox and Chrome. However, legacy browsers like Internet Explorer will not work with any Perseus app, unless you <em>polyfill</em> support for WebAssembly.</p>
</details>
<p>By the way, remember this little bit of code in <code>src/lib.rs</code>?</p>
<pre><code class="language-rust">    static_aliases: {
        &quot;/test.txt&quot; =&gt; &quot;static/test.txt&quot;
    }
</code></pre>
<p>If you navigate to <a href="http://localhost:8080/test.txt">http://localhost:8080/test.txt</a>, you should see the contents on <code>static/test.txt</code>! You can also access them at <a href="http://localhost:8080/.perseus/static/test.txt">http://localhost:8080/.perseus/static/test.txt</a></p>
<h2>Moving Forward</h2>
<p>Congratulations! You're now well on your way to building highly performant web apps in Rust! The remaining sections of this book are more reference-style, and won't guide you through building an app, but they'll focus instead on specific features of Perseus that can be used to make extremely powerful systems.</p>
<p>So go forth, and build!</p>
</div></main></div></div></div></div><footer class="w-full flex justify-center py-5 bg-gray-100 dark:bg-navy-deep"><p class="dark:text-white mx-5 text-center"><span>© <a href="https://github.com/arctic-hen7" class="underline">arctic-hen7</a> ⁨2021⁩, see license <a href="https://github.com/arctic-hen7/perseus/blob/main/LICENSE" class="underline">here</a>.</span></p></footer><script src=".perseus/static/prism.js" defer=""></script><script>window.Prism.highlightAll();</script></div></div>
    </body>
</html>
